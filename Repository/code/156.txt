using System;
using System.Collections;
using System.Management;

...

/* Methode zum Ermitteln der Grunddaten der installierten Soundkarten */
public static Hashtable EnumSoundcards()
{
   // HashTable für die Rückgabe erzeugen
   Hashtable soundcards = new Hashtable();

   // Abfragen der installierten Soundkarten
   ManagementObjectSearcher searcher = new ManagementObjectSearcher(
      "SELECT * FROM Win32_SoundDevice");
   ManagementObjectCollection moc = searcher.Get();
   foreach (ManagementBaseObject mbo in moc)
   {
      // DevideId (als Schlüssel) und ProductName (als Wert) 
      // an die Hashtable-Instanz anfügen
      soundcards.Add(mbo["DeviceId"], mbo["ProductName"]);
   }

   // ManagementObjectSearcher freigeben, um den Speicher möglichst schnell zu
   // entlasten
   searcher.Dispose();

   // StringCollection zurückgeben
   return soundcards;
}

